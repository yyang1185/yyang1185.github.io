---
 title: 测试实例总结 No.01
 categories: 测试实例
---

公司的 web app 中，下拉列表对象（boundlist）没有可用于识别的 unique 的 feature。
~~~~{html}
<div class="x-boundlist x-boundlist-floating x-layer x-boundlist-default x-border-box x-boundlist-above" style="width: 245px; right: auto; left: 443px; top: 152px; height: auto; z-index: 19000;" id="boundlist-2823" tabindex="0" componentid="boundlist-2823">
    <div id="boundlist-2823-listWrap" data-ref="listWrap" role="presentation" class="x-boundlist-list-ct x-unselectable" style="overflow: auto; height: auto;">
        <ul id="boundlist-2823-listEl" data-ref="listEl" class="x-list-plain">
                <li role="option" unselectable="on" class="x-boundlist-item x-boundlist-selected" tabindex="-1" data-recordindex="0" data-recordid="2125" data-boundview="boundlist-2823"><div style="vertical-align:top;"> <img src="" class="icon" align="left">&nbsp;None</div></li>
                <li role="option" unselectable="on" class="x-boundlist-item" tabindex="-1" data-recordindex="1" data-recordid="2126" data-boundview="boundlist-2823"><div style="vertical-align:top;"> <img src="/OneView/images/classofservice.gif" class="icon" align="left">&nbsp;Scavenger [Static]</div></li><li role="option" unselectable="on" class="x-boundlist-item" tabindex="-1" data-recordindex="2" data-recordid="2127" data-boundview="boundlist-2823"><div style="vertical-align:top;"> <img src="/OneView/images/classofservice.gif" class="icon" align="left">&nbsp;Best Effort [Static]</div></li><li role="option" unselectable="on" class="x-boundlist-item" tabindex="-1" data-recordindex="3" data-recordid="2128" data-boundview="boundlist-2823"><div style="vertical-align:top;"> <img src="/OneView/images/classofservice.gif" class="icon" align="left">&nbsp;Bulk Data [Static]</div></li><li role="option" unselectable="on" class="x-boundlist-item" tabindex="-1" data-recordindex="4" data-recordid="2129" data-boundview="boundlist-2823"><div style="vertical-align:top;"> <img src="/OneView/images/classofservice.gif" class="icon" align="left">&nbsp;Critical Data [Static]</div></li><li role="option" unselectable="on" class="x-boundlist-item" tabindex="-1" data-recordindex="5" data-recordid="2130" data-boundview="boundlist-2823"><div style="vertical-align:top;"> <img src="/OneView/images/classofservice.gif" class="icon" align="left">&nbsp;Network Control [Static]</div></li><li role="option" unselectable="on" class="x-boundlist-item" tabindex="-1" data-recordindex="6" data-recordid="2131" data-boundview="boundlist-2823"><div style="vertical-align:top;"> <img src="/OneView/images/classofservice.gif" class="icon" align="left">&nbsp;Network Management [Static]</div></li><li role="option" unselectable="on" class="x-boundlist-item" tabindex="-1" data-recordindex="7" data-recordid="2132" data-boundview="boundlist-2823"><div style="vertical-align:top;"> <img src="/OneView/images/classofservice.gif" class="icon" align="left">&nbsp;RTP/Voice/Video [Static]</div></li><li role="option" unselectable="on" class="x-boundlist-item" tabindex="-1" data-recordindex="8" data-recordid="2133" data-boundview="boundlist-2823"><div style="vertical-align:top;"> <img src="/OneView/images/classofservice.gif" class="icon" align="left">&nbsp;High Priority [Static]</div></li><li role="option" unselectable="on" class="x-boundlist-item" tabindex="-1" data-recordindex="9" data-recordid="2134" data-boundview="boundlist-2823"><div style="vertical-align:top;"> <img src="/OneView/images/classofservice.gif" class="icon" align="left">&nbsp;Access Control Web Redirect</div></li></ul></div></div>
~~~~

列表也没有对应的 `<select>` 部分，故而也无法使用 selenium 中的 Select 方法。


后用 xpath 获取 boundlist 中所有选项，进行 `.click()` 操作。使用 xpath 锁定 boundlist element 的关键是利用 `display:none` 特征。

尝试在已经被点开的 boundlist 中， 找到与 `display:none` 相对的特征。  关于这点，[stackoverflow] [2] 上相关词条首选建议如下：

> A true opposite to `display: none` there is not(yet).

> But `display: unset` is very close and works in most case.

> From [MDN] [1] :

> The unset CSS keyword is the combination of the initial and inherit keywords. Like these two other CSS-wide keywords, it can be applied to any CSS property, including the CSS shorthand all. This keyword resets the property to its inherited value if it inherits from its parent or to its initial value if not. In other words, it behaves like the inherit keyword in the first case and like the initial keyword in the second case.

>*(source: https://developer.mozilla.org/docs/Web/CSS/unset )*

> Note also that `display:revert` is currently being developed.

但是以上方法在实际运行中没有作用。所以选择在 xpath 中加入以下：`not(contains(@style, 'display: none;')`

完整 xpath 如下：
~~~~{xpath}
//*[contains(@class, 'x-boundlist') and not(contains(@style, 'display: none;'))]//*[contains(@class, 'x-boundlist-list-ct')]//*[contains(@class, 'x-list-plain')]
~~~~

另， [stackoverflow] [2] 上关于这个问题的最高票答案：

>`display: none` doesn’t have a literal opposite like` visibility:hidden` does.

>The` visibility` property decides whether an element is visible or not. It therefore has two states (`visible` and `hidden`), which are opposite to each other.

>The`display` property, however, decides what layout rules an element will follow. There are several different kinds of rules for how elements will lay themselves out in CSS, so there are several different values (`block`, `inline`, `inline-block` etc — [see the documentation for these values here] [3] ).

>`display:none` removes an element from the page layout entirely, as if it wasn’t there.

>All other values for `display` cause the element to be a part of the page, so in a sense they’re all opposite to `display:none`.

>But there isn’t one value that’s the direct converse of `display:none` - just like there's no one hair style that's the opposite of "bald".

参考 [stackoverflow] [4] 上的问答， 完成最后function如下：
~~~~{python}
def click_boundlist_item(bound_list_obj, item_inner_text):
    bound_list_obj.click()
    xpath = "//*[contains(@class, 'x-boundlist') and not(contains(@style, 'display: none;'))]//*[contains(@class, 'x-boundlist-list-ct')]//*[contains(@class, 'x-list-plain')]"
    bound_list = driver.find_element_by_xpath(xpath)
    options = list(bound_list.find_elements_by_tag_name('li'))
    for i in range(len(options)):
        item = options[i]
        if item_inner_text in item.get_attribute('innerText'):
            item.click()
            break
~~~~
其中，`options` 一行使用了 `.find_elements_by_tag_name()` 方法。 方法名是 `elements` 而不是 `element`。 此一类 `elements` 方法可以返回当前页面元素下的所有符合选择条件的子路径。返回类型是 list 型(python)。

Reference: [selenium-python docs] [5]

改进：

需要添加 exception handling。

可尝试运用 selenium 的 .isdisplayed 方法。

[1]: https://developer.mozilla.org/docs/Web/CSS/unset
[2]: http://stackoverflow.com/questions/17630945/is-there-an-opposite-to-displaynone
[3]: https://www.w3.org/TR/CSS2/visuren.html#display-prop
[4]: http://stackoverflow.com/questions/16296490/how-to-handle-combo-boxes-of-extjs-in-selenium-webdriver
[5]: https://selenium-python.readthedocs.io/locating-elements.html
